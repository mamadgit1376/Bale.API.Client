# Mohammad.Bale.Bot.Client

GitHub:
https://github.com/mamadgit1376/Bale.API.Client

ÛŒÚ© Ú©Ù„Ø§ÛŒÙ†Øª Ø¯Ø§Øªâ€ŒÙ†Øª Ø³Ø§Ø¯Ù‡ØŒ Ù…Ø¯Ø±Ù† Ùˆ Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø± Ø¨Ø§ **API Ø¨Ø§Ø²ÙˆÛŒ Ù¾ÛŒØ§Ù…â€ŒØ±Ø³Ø§Ù† Ø¨Ù„Ù‡**. Ø§ÛŒÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ØªÙ…Ø§Ù… Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ HTTP Ø±Ø§ Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù‡ Ùˆ Ø¨Ù‡ Ø´Ù…Ø§ Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ ØªØ§ Ø¨Ù‡ Ø±Ø§Ø­ØªÛŒ Ø¨Ø§ Ù…ØªØ¯Ù‡Ø§ Ùˆ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„Ø§Ù‹ ØªØ§ÛŒÙ¾â€ŒØ´Ø¯Ù‡ (Strongly-typed) Ø¨Ø§ Ø³Ø±ÙˆØ±Ù‡Ø§ÛŒ Ø¨Ù„Ù‡ ØªØ¹Ø§Ù…Ù„ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯.

## ğŸš€ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§

  - **Ú©Ø§Ù…Ù„Ø§Ù‹ ØºÛŒØ±Ù‡Ù…Ø²Ù…Ø§Ù† (Async):** ØªÙ…Ø§Ù… Ù…ØªØ¯Ù‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª `async/await` Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯.
  - **Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ Ø§Ø² API:** ØªÙ…Ø§Ù… Ù…ØªØ¯Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø±Ø³Ù…ÛŒ Ø¨Ø§Ø²ÙˆÛŒ Ø¨Ù„Ù‡ Ø±Ø§ Ù¾ÙˆØ´Ø´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.
  - **Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Strongly-Typed:** ØªÙ…Ø§Ù… Ø¢Ø¨Ø¬Ú©Øªâ€ŒÙ‡Ø§ÛŒ API (Ù…Ø§Ù†Ù†Ø¯ `Message`, `Update`, `Chat`) Ø¨Ù‡ ØµÙˆØ±Øª Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ C\# Ù…Ø¯Ù„â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯.
  - **Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¢Ø³Ø§Ù†:** Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ÛŒÚ© Ù…ØªØ¯ Ú©Ù…Ú©ÛŒ (Extension Method) Ø¨Ù‡ Ø±Ø§Ø­ØªÛŒ Ø¯Ø± Ø³ÛŒØ³ØªÙ… ØªØ²Ø±ÛŒÙ‚ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ (Dependency Injection) Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ ASP.NET Core Ø«Ø¨Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯.
  - **Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ù‡ÛŒÙ†Ù‡ HttpClient:** Ø¨Ø§ Ø¨Ù‡Ø±Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø² `IHttpClientFactory` Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ù‡ÛŒÙ†Ù‡ Ø§Ø±ØªØ¨Ø§Ø·Ø§Øª Ùˆ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø±Ø§ÛŒØ¬.
  - **Ø¨Ø¯ÙˆÙ† ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ Ø§Ø¶Ø§ÙÛŒ:** Ø¨Ø³ÛŒØ§Ø± Ø³Ø¨Ú© Ùˆ Ø¨Ø§ Ø­Ø¯Ø§Ù‚Ù„ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§.

## ğŸ”§ Ù†ØµØ¨

Ø´Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§ÛŒÙ† Ù¾Ú©ÛŒØ¬ Ø±Ø§ Ø§Ø² Ø·Ø±ÛŒÙ‚ NuGet Gallery Ø¨Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡ Ø®ÙˆØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯.

**Ø§Ø² Ø·Ø±ÛŒÙ‚ .NET CLI:**

```bash
dotnet add package Mohammad.Bale.Bot.Client
```

**Ø§Ø² Ø·Ø±ÛŒÙ‚ Package Manager Console:**

```powershell
Install-Package Mohammad.Bale.Bot.Client
```

## ğŸ Ø´Ø±ÙˆØ¹ Ø³Ø±ÛŒØ¹

Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø¯Ø± ÛŒÚ© Ù¾Ø±ÙˆÚ˜Ù‡ ASP.NET Core Ø¨Ø³ÛŒØ§Ø± Ø³Ø§Ø¯Ù‡ Ø§Ø³Øª.

### Û±. Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ `appsettings.json`

Ø§Ø¨ØªØ¯Ø§ ØªÙˆÚ©Ù† Ø±Ø¨Ø§Øª Ø®ÙˆØ¯ Ø±Ø§ Ú©Ù‡ Ø§Ø² `@BotFather` Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯ØŒ Ø¯Ø± ÙØ§ÛŒÙ„ `appsettings.json` Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯.

```json
{
  "BaleBotSettings": {
    "BotToken": "YOUR_UNIQUE_BOT_TOKEN_FROM_BOTFATHER"
  }
}
```

### Û². Ø«Ø¨Øª Ø³Ø±ÙˆÛŒØ³ Ø¯Ø± `Program.cs`

Ø³Ù¾Ø³ØŒ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…ØªØ¯ Ú©Ù…Ú©ÛŒ `AddBaleBotClient`ØŒ Ø³Ø±ÙˆÛŒØ³ Ø±Ø§ Ø¯Ø± `Program.cs` Ø«Ø¨Øª Ú©Ù†ÛŒØ¯.

```csharp
using Bale.Bot.Client; // using Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯

var builder = WebApplication.CreateBuilder(args);

// ... Ø³Ø§ÛŒØ± Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§

// Ø«Ø¨Øª Ú©Ù„Ø§ÛŒÙ†Øª Ø±Ø¨Ø§Øª Ø¨Ù„Ù‡
builder.Services.AddBaleBotClient(options =>
{
    options.BotToken = builder.Configuration["BaleBotSettings:BotToken"];
});

var app = builder.Build();

// ...
```

### Û³. Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Ú©Ù†ØªØ±Ù„Ø±

Ø­Ø§Ù„Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§ÛŒÙ†ØªØ±ÙÛŒØ³ `IBaleBotClient` Ø±Ø§ Ø¨Ù‡ Ù‡Ø± Ú©Ù†ØªØ±Ù„Ø± ÛŒØ§ Ø³Ø±ÙˆÛŒØ³ÛŒ ØªØ²Ø±ÛŒÙ‚ Ú©Ø±Ø¯Ù‡ Ùˆ Ø§Ø² Ù…ØªØ¯Ù‡Ø§ÛŒ Ø¢Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.

```csharp
using Bale.Bot.Client.Interfaces;
using Bale.Bot.Client.Models; // Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù…Ø¯Ù„â€ŒÙ‡Ø§
using Microsoft.AspNetCore.Mvc;

[ApiController]
[Route("api/[controller]")]
public class BotController : ControllerBase
{
    private readonly IBaleBotClient _baleClient;

    public BotController(IBaleBotClient baleClient)
    {
        _baleClient = baleClient;
    }

    /// <summary>
    /// Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±Ø¨Ø§Øª Ø±Ø§ Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
    /// </summary>
    [HttpGet("me")]
    public async Task<IActionResult> GetMe()
    {
        try
        {
            var response = await _baleClient.GetMeAsync();
            return Ok(response.Result);
        }
        catch (Exception ex)
        {
            return BadRequest(ex.Message);
        }
    }

    /// <summary>
    /// ÛŒÚ© Ù¾ÛŒØ§Ù… "Ø³Ù„Ø§Ù… Ø¯Ù†ÛŒØ§" Ø¨Ù‡ Ú†Øª Ù…Ø´Ø®Øµ Ø´Ø¯Ù‡ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
    /// </summary>
    [HttpPost("send-hello")]
    public async Task<IActionResult> SendHelloMessage([FromQuery] string chatId)
    {
        try
        {
            var response = await _baleClient.SendMessageAsync(chatId, "Ø³Ù„Ø§Ù… Ø¯Ù†ÛŒØ§ Ø§Ø² Ø·Ø±Ù Ø±Ø¨Ø§Øª!");
            return Ok(response.Result);
        }
        catch (Exception ex)
        {
            return BadRequest(ex.Message);
        }
    }
}
```

## Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±

### Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ú©ÛŒØ¨ÙˆØ±Ø¯ Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ (Inline Keyboard)

```csharp
[HttpPost("send-with-keyboard")]
public async Task<IActionResult> SendMessageWithKeyboard([FromQuery] string chatId)
{
    var inlineKeyboard = new InlineKeyboardMarkup
    {
        InlineKeyboard = new[]
        {
            // Ø±Ø¯ÛŒÙ Ø§ÙˆÙ„
            new[]
            {
                new InlineKeyboardButton { Text = "Ú¯ÙˆÚ¯Ù„", Url = "https://google.com" },
                new InlineKeyboardButton { Text = "Ú©Ù„ÛŒÚ© Ú©Ù†!", CallbackData = "button1_clicked" }
            },
            // Ø±Ø¯ÛŒÙ Ø¯ÙˆÙ…
            new[]
            {
                new InlineKeyboardButton { Text = "Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ±", CallbackData = "show_more_info" }
            }
        }
    };

    try
    {
        await _baleClient.SendMessageAsync(chatId, "ÛŒÚ© Ú¯Ø²ÛŒÙ†Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯:", replyMarkup: inlineKeyboard);
        return Ok("Ù¾ÛŒØ§Ù… Ø¨Ø§ Ú©ÛŒØ¨ÙˆØ±Ø¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.");
    }
    catch (Exception ex)
    {
        return BadRequest(ex.Message);
    }
}
```

### Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§Ù‡Ø§

Ø§ÛŒÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø¯Ø± ØµÙˆØ±Øª Ø¨Ø±ÙˆØ² Ø®Ø·Ø§ Ø§Ø² Ø³Ù…Øª API Ø¨Ù„Ù‡ØŒ ÛŒÚ© Ø§Ø³ØªØ«Ù†Ø§ Ø§Ø² Ù†ÙˆØ¹ `BaleApiException` Ù¾Ø±ØªØ§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¢Ù† Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ù‡ØªØ± Ø®Ø·Ø§Ù‡Ø§ `catch` Ú©Ù†ÛŒØ¯.

```csharp
using Bale.Bot.Client.Exceptions;

// ...

[HttpGet("me-safe")]
public async Task<IActionResult> GetMeSafely()
{
    try
    {
        var response = await _baleClient.GetMeAsync();
        return Ok(response.Result);
    }
    catch (BaleApiException ex)
    {
        // Ø®Ø·Ø§Ù‡Ø§ÛŒ Ù…Ø´Ø®Øµ Ø§Ø² Ø³Ù…Øª API Ø¨Ù„Ù‡ (Ù…Ø§Ù†Ù†Ø¯ ØªÙˆÚ©Ù† Ù†Ø§Ù…Ø¹ØªØ¨Ø±)
        return StatusCode((int)ex.StatusCode, new { message = ex.Message, details = ex.ErrorContent });
    }
    catch (HttpRequestException ex)
    {
        // Ø®Ø·Ø§Ù‡Ø§ÛŒ Ú©Ù„ÛŒ Ø´Ø¨Ú©Ù‡
        return StatusCode(503, "Ø³Ø±ÙˆÛŒØ³ Ø¨Ù„Ù‡ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª.");
    }
}
```

## ğŸ¤ Ù…Ø´Ø§Ø±Ú©Øª

Ø§Ø² Ù‡Ø±Ú¯ÙˆÙ†Ù‡ Ù…Ø´Ø§Ø±Ú©Øª Ø¯Ø± Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ù„Ø·ÙØ§Ù‹ Ø¨Ø±Ø§ÛŒ Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø§Ú¯ ÛŒØ§ Ø§Ø±Ø§Ø¦Ù‡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ØŒ ÛŒÚ© Issue Ø¬Ø¯ÛŒØ¯ Ø¯Ø± Ù…Ø®Ø²Ù† Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ Ù¾Ø±ÙˆÚ˜Ù‡ Ø«Ø¨Øª Ú©Ù†ÛŒØ¯.


